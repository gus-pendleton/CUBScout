<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Expressivity Prediction · CUBScout.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://gus-pendleton.github.io/CUBScout.jl/exp/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="CUBScout.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="CUBScout.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CUBScout.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../cub/">Codon Usage Bias</a></li><li class="is-active"><a class="tocitem" href>Expressivity Prediction</a><ul class="internal"><li><a class="tocitem" href="#Under-default-conditions"><span>Under default conditions</span></a></li><li><a class="tocitem" href="#GCB-specific-Arguments"><span>GCB-specific Arguments</span></a></li></ul></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../reference/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Expressivity Prediction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Expressivity Prediction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gus-pendleton/CUBScout.jl/blob/main/docs/src/exp.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Expressivity-Predictions"><a class="docs-heading-anchor" href="#Expressivity-Predictions">Expressivity Predictions</a><a id="Expressivity-Predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Expressivity-Predictions" title="Permalink"></a></h1><h2 id="Under-default-conditions"><a class="docs-heading-anchor" href="#Under-default-conditions">Under default conditions</a><a id="Under-default-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Under-default-conditions" title="Permalink"></a></h2><p>Expressivity predictions based on codon usage bias can be calculated with the functions <code>cai()</code>, <code>e()</code>, <code>fop()</code>, <code>gcb()</code>, and <code>melp()</code>. All expressivity functions (besides <code>gcb</code>) require two arguments:</p><ul><li><code>filepath(s)</code>: <code>String</code> or <code>Vector{String}</code> of filepaths to fasta file(s)</li><li><code>ref_vector(s)</code>: <code>Vector{Bool}</code> or <code>Vector{Vector{Bool}}</code> identifying reference subsets for each file.</li></ul><div class="admonition is-info"><header class="admonition-header">Why do expressivity functions accept reference subsets in a different format than codon usage bias functions?</header><div class="admonition-body"><p>You may have noticed that for codon usage bias functions, you need to provide a named tupled of reference sequences, while in expressivity functions, you just need to provide the vector. Why did I make this so complicated for you? Well, for expressivity functions, a reference subset is <strong>required</strong>, and you can only provide a single reference subset. Because this is more strict, the function could be written less flexibly. However, codon usage bias functions can accept no reference subsets, one reference subset, or multiple reference subsets. As such, the named tuple format is necessary to differentiate your input and provide differentiated output.</p></div></div><p>Let&#39;s calculate MELP on our example data, using ribosomal proteins as a reference subset. </p><pre><code class="language-julia-repl hljs">julia&gt; ribosomal_genes = find_seqs(EXAMPLE_DATA_PATH, r&quot;ribosomal&quot;);

julia&gt; melp_result = melp(EXAMPLE_DATA_PATH, ribosomal_genes);

julia&gt; melp_result.MELP
3801-element Vector{Float64}:
 0.9294138732153456
 1.007671319249364
 0.9223573085968517
 0.9512392602630869
 1.0295311265835025
 1.0749743120487463
 ⋮
 1.0147105407479773
 0.9929945778238751
 0.9682178480589456
 0.9651731383865032
 0.8840414848184831</code></pre><p>The functions <code>cai</code>, <code>e</code>, <code>fop</code>, and <code>melp</code> all accept the same arguments. Their optional arguments are the same as codon usage bias functions, including options to specify a custom <code>CodonDict</code>, remove start or stop codons, and set a filtering threshold. They also handle multiple files and multi-threading in the same way, and so I do not recommend broadcasting these functions.</p><h2 id="GCB-specific-Arguments"><a class="docs-heading-anchor" href="#GCB-specific-Arguments">GCB-specific Arguments</a><a id="GCB-specific-Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#GCB-specific-Arguments" title="Permalink"></a></h2><p>Because of the iterative way GCB is calculated, its arguments differ slightly from other expressivity functions. Namely:</p><ul><li>GCB uses a &quot;seed&quot; reference subset. By default, this is set to &quot;self&quot;, and so is an optional argument. Custom <code>ref_vector(s)</code> can be supplied if so desired, as a keyword argument</li><li>GCB iteratively calculates the GCB measure and then uses the genes with highest GCB values as a reference subset in the next iteration. The <code>perc</code> argument specifies what percent of the of genes is used a reference subset. By default, <code>perc = 0.05</code>, or 5%. </li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cub/">« Codon Usage Bias</a><a class="docs-footer-nextpage" href="../functions/">Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 20 June 2023 20:14">Tuesday 20 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
